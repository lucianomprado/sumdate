!function(t){t.fn.sumdate=function(n){var i=new Array,a=e.populaConfig(n),s=new Array;if(t.each(this,function(){var e=t(this).val()||t(this).text();a.date=e;try{n.update?""!=t(this).val()?t(this).val(t.sumdate(a)):t(this).text(t.sumdate(a)):i.push(t.sumdate(a))}catch(r){var o={ok:!1,msg:r,fieldMSG:t(this).attr("msg"),fieldID:t(this).attr("id"),fieldName:t(this).attr("name")};s.push(o)}}),s.length>0&&a.internationalisation.display){var r=0,o=s.error+"<br/>";for(r=0;r<s.length;r++)o+=(s[r].fieldMSG||s[r].fieldID||s.fieldName)+": "+s[r].msg+(r<s.length-1?"<br/>":"");if(a.internationalisation.divErrorId&&t("#"+a.internationalisation.divErrorId).html(o),s.length>0&&a.internationalisation.jsonError){var s={errors:s,values:i};return s}}return n.update?void 0:i},t.sumdate=function(t){var n=e.populaConfig(t);if(n.functions.length>0)for(var a=0;a<n.functions.length;a++)i=e[n.functions[a]](n);return i};var e={sum:function(i){var a=i.sumValues,s=i.date,r=!1;if("string"==t.type(s)){if(!e.validate(i))throw n.invalidDate;s=e.stringToDate(i),r=!0}var o=new Date(s.getTime());if(o.setMilliseconds(o.getMilliseconds()+a.milliseconds),o.setSeconds(o.getSeconds()+a.seconds),o.setMinutes(o.getMinutes()+a.minutes),o.setHours(o.getHours()+a.hours),o.setDate(o.getDate()+a.days),a.days>0)o.setMonth(o.getMonth()+a.months);else{var l=e.getMaxDayOfMonth(s.getMonth()+a.months,s.getFullYear());o.setDate(s.getDate()>l?l:s.getDate()),o.setMonth(o.getMonth()+a.months)}return o.setFullYear(o.getFullYear()+a.years),i.date=o,r&&(o=e.dateToString(i)),o},stringToDate:function(e){var n=e.date,a=e.pattern;if("date"==t.type(n))return n;var s=new Date(0);s.setHours(0);for(var r=new SplitDate(n,a),o=r.getOrder(),l=0,u=0,d=0,g=0,h=0,v=0,f=0,p=r.split(),D=p[1],m=p[0],c=0;c<a.length;c++)o.D==c?(l=parseInt(D[f],10),f++):o.M==c?(u=parseInt(D[f],10)-1,f++):o.Y==c&&(d=parseInt(D[f],10),f++);if(s.setFullYear(d,u,l),""!=m){f=0;for(var c=0;c<i.length;c++)o.h==c?(g=parseInt(m[f],10),f++):o.m==c?(h=parseInt(m[f],10),f++):o.ss==c&&(v=parseInt(m[f],10),f++);s.setHours(g),s.setMinutes(h),s.setSeconds(v)}return s},dateToString:function(e){var n=e.date,i=e.pattern;if("string"==t.type(n))return n;for(var a=new String,s=new SplitDate("",i),r=s.getOrder(),o=s.getCharsSep(),l=0,u=0,d=0;d<i.length;d++)r.D==d?(n.getDate()<10&&(a+="0"),a+=n.getDate(),2>l&&(a+=o.date),l++):r.M==d?(n.getMonth()<9&&(a+="0"),a+=n.getMonth()+1,2>l&&(a+=o.date),l++):r.Y==d&&(a+=n.getFullYear(),2>l&&(a+=o.date),l++),r.h==d?(n.getHours()<10&&(a+="0"),a+=n.getHours(),2>u&&(a+=o.time),u++):r.m==d?(n.getMinutes()<10&&(a+="0"),a+=n.getMinutes(),2>u&&(a+=o.time),u++):r.ss==d&&(n.getSeconds()<10&&(a+="0"),a+=n.getSeconds(),2>u&&(a+=o.time),u++),"null"!=o.divDT&&3==l^3==u&&(a+=o.divDT,o.divDT="null");return a},validate:function(n){var i=n.date,a=n.pattern;if("string"!=t.type(i))return!1;var s=e.getPos(a),r=e.charsSeps(a,s),o=e.stringToDate(n);if(""==i)return!0;var l=[];if("null"!=r.divDT){var u=i.split(r.divDT);s.D<s.h?(l.splice(-1,0,u[0].split(r.date)),l.splice(-1,0,u[1].split(r.time))):(l.splice(-1,0,u[1].split(r.date)),l.splice(-1,0,u[0].split(r.time)))}else""!=r.date?l=i.split(r.date):""!=r.time&&(l=i.split(r.time));for(var d=0;d<l.length;d++){if(s.D==d&&o.getDate()!=parseInt(l[d]))return!1;if("M"==s[d]&&o.getMonth()+1!=parseInt(l[d]))return!1;if("Y"==s[d]&&o.getFullYear()!=parseInt(l[d]))return!1;if("h"==s[d]&&o.gethours()!=parseInt(l[d]))return!1;if("m"==s[d]&&o.getMinutes()!=parseInt(l[d]))return!1;if("ss"==s[d]&&o.getSeconds()!=parseInt(l[d]))return!1}return!0},between:function(i){var a=i,s=i.date,r=i.anotherDate;if("string"==t.type(s)){if(!e.validate(i))throw n.invalidDate;s=e.stringToDate(i)}if("string"==t.type(r)){if(a.date=r,!e.validate(a))throw n.invalidDate+" ("+n.inAnotherDate+")";r=e.stringToDate(a)}var o=r.getTime()-s.getTime();o=0>o?-1*o:o;var l=new Date(o),u={years:0,months:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0};return u.years=l.getUTCFullYear()-1970,u.months=l.getUTCMonth(),u.days=l.getUTCDate()-1,u.hours=l.getUTCHours(),u.minutes=l.getUTCMinutes(),u.milliseconds=l.getUTCMilliseconds(),u},getPos:function(t){var e={D:-1,M:-1,Y:-1,h:-1,m:-1,ss:-1};if(e.D=t.indexOf("DD"),e.M=t.indexOf("MM"),e.Y=t.indexOf("YYYY"),e.h=t.indexOf("hh"),e.m=t.indexOf("mm"),e.ss=t.indexOf("ss"),-1==e.D&&-1==e.M&&e.Y&&-1==e.h&&-1==e.m&&-1==e.ss)throw n.invalidPattern;return e},charsSeps:function(e,i){var a="",s="",r=null,o=0,l=0;if((i.D>0||i.M>0)&&(i.D<i.Y?(a=e.substr(i.D+2,1),o=i.Y>i.M?i.Y:i.M):(a=e.substr(i.Y+4,1),o=i.D>i.M?i.D:i.M)),(i.h>0||i.m>0)&&(i.h<i.m?(s=e.substr(i.h+2,1),l=i.h>i.ss?i.ss:i.h):(s=e.substr(i.m+2,1),l=i.m>i.ss?i.ss:i.m)),o>0&&l>0&&(r=o>l?e.substr(o-1,1):e.substr(l-1,1)),""==a&&""==s)throw n.invalidPattern;var u='{ "date": "'+a+'", "time": "'+s+'", "divDT": "'+r+'"}';return t.parseJSON(u)},populaConfig:function(e){var i={years:0,months:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0},a={error:"Error",invalidDate:"invalid date",invalidPattern:"invalid pattern",inAnotherDate:"in another date"},s={language:{},display:!1,divErrorId:void 0,jsonError:!0},r={date:"",anotherDate:"",sumValues:{},functions:["sum"],pattern:"DD/MM/YYYY",internationalisation:{}};return e&&(e.sumValues&&t.extend(i,e.sumValues),e.internationalisation&&t.extend(s,e.internationalisation),e.internationalisation&&e.internationalisation.language&&t.extend(a,e.internationalisation.language),e.sumValues=i,e.internationalisation=s,e.internationalisation.language=a,t.extend(r,e)),n=r.internationalisation.language,r},getMaxDayOfMonth:function(t,e){var n=new Date(0);n.setHours(0),n.setMonth(parseInt(t,10)),n.setFullYear(parseInt(e,10));var i=32;do n.setMonth(parseInt(t,10)),i-=1,n.setDate(i);while(n.getMonth()!=t);return i}};SplitDate=function(t,i){var a=t,s=e.getPos(i),r=e.charsSeps(i,s);this.getOrder=function(){return s},this.getCharsSep=function(){return r},this.split=function(){var t="",e="";if("null"!=r.divDT?s.h>s.Y?(t=a.split(r.divDT)[0].split(r.date),e=a.split(r.divDT)[1].split(r.time)):(t=a.split(r.divDT)[1].split(r.date),e=a.split(r.divDT)[0].split(r.time)):""!=r.date?t=a.split(r.date):e=a.split(r.time),(""!=a&&""==t||void 0==t)&&(""==e||void 0==e))throw n.invalidDate;return[e,t]}};var n={},i={ok:!0,valor:"",msg:""}}(jQuery);